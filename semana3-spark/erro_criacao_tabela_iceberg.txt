âœ… DiagnÃ³stico resumido
âŒ Erro que vocÃª estÃ¡ vendo:

Location does not exist: s3://warehouse/bootcamp/events/metadata/00000-xxxxxxxx.metadata.json
Isso significa que o REST Catalog registrou a tabela bootcamp.events, mas os arquivos (metadados Iceberg) que deveriam estar no bucket warehouse do MinIO nÃ£o existem (foram apagados ou nunca foram criados).

âœ… SoluÃ§Ã£o segura
ğŸ§¹ 1. Apague o bucket warehouse (jÃ¡ estÃ¡ no seu container mc)
Esse trecho do seu mc jÃ¡ faz isso ao subir:

/usr/bin/mc rm -r --force minio/warehouse;
Isso apaga os dados do bucket, mas nÃ£o apaga as tabelas do catÃ¡logo REST â€” ou seja, o catÃ¡logo ainda acredita que a tabela bootcamp.events existe, mesmo sem metadados.

ğŸ’¥ 2. EntÃ£o, reiniciar os containers nÃ£o resolve o problema
VocÃª precisa apagar a entrada da tabela no catÃ¡logo REST.

âœ… Como resolver corretamente
ğŸ”§ OpÃ§Ã£o A â€” apagar a tabela com DROP TABLE (se ainda funcionar)
Tente executar no Spark:

DROP TABLE IF EXISTS bootcamp.events;
Se funcionar, Ã³timo â€” vocÃª poderÃ¡ criar de novo depois.

Se der erro novamente, vÃ¡ para a opÃ§Ã£o B.

ğŸ§¨ OpÃ§Ã£o B â€” apagar a entrada diretamente no REST Catalog (via API)
O tabulario/iceberg-rest implementa o Iceberg REST Catalog API, entÃ£o vocÃª pode deletar a tabela diretamente via curl, assim:

curl -X DELETE http://localhost:8181/v1/namespaces/bootcamp/tables/matches_bucketed
Use esse comando no host, ou http://iceberg-rest:8181/... se for de dentro de um container.

âœ… Depois de limpar tudo...
VocÃª pode recriar sua tabela normalmente:

CREATE TABLE IF NOT EXISTS bootcamp.events (
    url STRING,
    referrer STRING,
    browser_family STRING,
    os_family STRING,
    device_family STRING,
    host STRING,
    event_time TIMESTAMP,
    event_date DATE
)
USING iceberg
PARTITIONED BY (years(event_date));
